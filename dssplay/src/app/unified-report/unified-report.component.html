<fui-sidebar-container>
    <fui-sidebar
        [transition]="'overlay'"
        [isVisible]="show_sidebar"
        class="inverted vertical very wide translucent raised segment"
        direction="right"
        #sidebar
    >

        <div class="ui inverted dense segment">
            <app-metrics
                [mode]="'mapping'"
                (metricsChange)="onMetricsChange($event)"
            >
            </app-metrics>
            <app-choiceflow></app-choiceflow>
            <app-mapping-options
                [(metrics)]="metrics"
                (fuelChange)="onFuelChange($event)"
                (harvest_on)="on_harvesting($event)"
                (harvest_off)="off_harvesting($event)"
                (burnTargetsChange)="onBurnTargetsChange($event)"
            >
            </app-mapping-options>
        </div>

    </fui-sidebar>


    <fui-sidebar-sibling
        [isDimmedWhenVisible]="false"
        class="fullscreen"
    >

        <div class="ui inverted bdazzledblue menu toolbar top attached">
            <div class="right menu">
            <a
                class="item"
                (click)="show_sidebar = !show_sidebar"
                (mouseover)="show_sidebar = true;"
            >
                <i class="wrench icon"></i> Tools
            </a>
            </div>
        </div>

        <fui-dimmer [(isDimmed)]="tableIsDimmed" isClickable="false">
        <div class="loader"></div></fui-dimmer>
    <!-- <app-sql-builder [the_query]="query"></app-sql-builder> -->

    <app-dataframe-table
        [results]="results"
        (orderChange)="onOrderChange($event)"
        (limitChange)="onLimitChange($event)"
    >
</app-dataframe-table>

        <div class="ui stackable two column grid">
            <div class="ui column">

                <div
                    class="ui inverted segment"
                    resizable
                >
                    <div class="ui grid">
                        <div class="ui row">
                            <div class="ui five wide column">
                                <app-y-axis-chooser></app-y-axis-chooser>
                                <div class="ui divider"></div>
                                <app-interpretation></app-interpretation>
                            </div>
                            <div class="ui eleven wide column">
                                <h2 class="ui inverted header">(Chart Title)</h2>
                                <div class="ui segment chart-container">
                                    <canvas
                                        id='boxchart'
                                        #boxchart
                                    ></canvas>
                                </div>
                                <app-x-axis-chooser></app-x-axis-chooser>
                            </div>
                        </div>
                        <div class="ui row">
                            <div class="ui five wide column"></div>
                            <div class="ui eleven wide column">
                                <div class="ui segment chart-container">
                                    <canvas
                                        id='violin'
                                        #violin
                                    ></canvas>
                                </div>
                            </div>
                            <!-- <div class="ui eight wide column">
                          <div class="ui segment chart-container">
                            <canvas id='scatterchart' #scatterchart></canvas>
                          </div>
                        </div> -->
                        </div>
                        <div class="ui row">
                            <div class="ui eight wide column">
                                <!-- <app-dataframe-table
                                    [results]="results"
                                    (orderChange)="onOrderChange($event)"
                                    (limitChange)="onLimitChange($event)"
                                >
                                </app-dataframe-table> -->
                            </div>
                            <div class="ui eight wide column">
                                <app-stats-panel></app-stats-panel>
                            </div>
                        </div>

                        <app-sql-controller></app-sql-controller>
                    </div>
                </div>
            </div>
            <div class="ui column">

                <div
                    class="ui inverted segment"
                    resizable
                >
                    <!-- <div *ngIf="sources.length > 0"> -->
                    <mgl-map
                        [style]="style"
                        [zoom]="zoom"
                        [center]="[145.769, -37.721]"
                        [fitBounds]="bounds"
                        [fitBoundsOptions]="boundsOptions"
                        (mouseMove)="mousemove($event)"
                        (load)="mapLoaded($event)"
                        #mapview
                    >

                        <!-- <mgl-geojson-source
              id="src.id"
              [data]="src.data"
              *ngFor="let src of sources">

              <mgl-feature
              *ngFor="let geometry of src.geometries"
              [geometry]="geometry"></mgl-feature>

            </mgl-geojson-source>

            <mgl-layer
              *ngFor="let lyr of sources.layers"

              id="lyr.name"
              type="line"
              [source]="lyr.source"
              [paint]="{
                'line-color': '#627BC1',
                'line-width': 2
              }"
            ></mgl-layer> -->

                    </mgl-map>
                    <!-- </div> -->
                </div>

            </div>
        </div>

    </fui-sidebar-sibling>
</fui-sidebar-container>
